<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    
    <title>Nahla Tracker</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=VT323&display=swap">


        <!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:title" content="Nahla Tracker">
<meta property="og:description" content="Live day/night tracker and gallery for Nahla, a remote Elite Dangerous moon.">
<meta property="og:url" content="https://lysander666.github.io/nahla-tracker/">
<meta property="og:image" content="https://lysander666.github.io/nahla-tracker/social-card.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Nahla Tracker">
<meta name="twitter:description" content="Live day/night tracker and gallery for Nahla, a remote Elite Dangerous moon.">
<meta name="twitter:image" content="https://lysander666.github.io/nahla-tracker/social-card.jpg">


    <link id="favicon" rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='80'>üåï</text></svg>">
    
    <style>
        body { 
            background-color: #1a1a1a; 
            color: #e0e0e0; 
            font-family: monospace; 
            font-size: 1.1rem; 
            line-height: 1.6; 
            padding: 20px;
        }
        .container {
            max-width: 1800px;
            margin: 0 auto;
        }
        
        h2 {
            text-align: center;
        }
        
        #tracker { 
            padding: 20px; 
            border: 1px solid #444; 
            background-color: #2a2a2a;
            border-radius: 8px;
            margin-bottom: 25px;
            text-align: center; 
        }

        #moonclock {
            font-family: "Consolas", "Courier New", monospace;
            font-size: 1.2rem;
            color: #3af2ff;
            text-shadow: 0 0 8px #3af2ff, 0 0 14px #007a85;
            text-align: center;
            margin-top: 8px;
            letter-spacing: 2px;
        }

        #moonclock-coordinated {
            font-family: "Consolas", "Courier New", monospace;
            font-size: 1.2rem;
            color: #ff61c7;
            text-shadow: 0 0 8px #ff61c7, 0 0 14px #852c66;
            text-align: center;
            margin-top: 4px;
            letter-spacing: 2px;
}


        .time-highlight {
          color: #61dafb;   /* cyan, same tone as your UI highlights */
          font-weight: bold;
        }

#notes-box {
    background-color: #1e1e1e;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
    box-shadow: 0 0 12px rgba(97, 218, 251, 0.1);
}

#notes-box h2 {
    color: #61dafb;
    margin-top: 0;
    margin-bottom: 10px;
    font-family: "Consolas", "Courier New", monospace;
}

/* Make Notes text smaller on mobile */
@media (max-width: 600px) {
  #notes-box, 
  #notes-box p, 
  #notes-box div, 
  #notes-box span {
    font-size: 0.85rem !important;
    line-height: 1.45;
  }
}




#notes {
    background-color: #121212;
    border: 1px solid #333;
    border-radius: 6px;
    color: #ccc;
    font-family: "Inter", sans-serif;
    font-size: 0.95rem;
    padding: 8px 10px;
    line-height: 1.5;
    text-align: justify;
}


        .gallery-container {
          cursor: grab;
        }

        .gallery-container:active {
          cursor: grabbing;
        }

.gallery-header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
    margin-bottom: 15px;
    height: 40px;
}

.gallery-header h2 {
    color: #61dafb;
    margin: 0;
    text-align: center;
    position: relative;
    top: 8px;  /* <-- Use this instead of margin-top */
}







.gallery-btn {
    background: none;
    border: 2px solid #61dafb;
    color: #61dafb;
    font-size: 1.5rem;
    width: 40px;
    height: 40px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: monospace;
    flex-shrink: 0;
    padding: 0;           /* <-- ADD THIS */
    outline: none;        /* <-- ADD THIS */
    -webkit-appearance: none;  /* <-- ADD THIS */
    appearance: none;     /* <-- ADD THIS */
}

.gallery-btn:hover {
    background-color: #61dafb;
    color: #1a1a1a;
    transform: scale(1.1);
}

.gallery-btn:active {
    transform: scale(0.95);
}
        
        /* --- Main 5-Column Layout --- */
        #system-info-container {
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }
        
        .celestial-body, #map-panel, #manifest-panel {
            flex: 1;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 0 20px 20px 20px;
            background-color: #222;
            height: 580px; /* Fixed height to match map panel THIS IS THE REFERENCE BOX SIZE FOR ALL BOXES*/
            overflow-y: auto; /* Enable scrolling for all boxes */
        }
        
        .celestial-body h3, #map-panel h3, #manifest-panel h3 {
            color: #61dafb;
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
            position: sticky;
            top: 0;
            background-color: #222;
            margin: 0;
            padding-top: 20px;
        }
        
        .celestial-body ul, #map-panel ul {
            list-style-type: none;
            padding-left: 0;
            font-size: 0.9rem;
            color: #ccc;
        }
        .celestial-body li, #map-panel li {
            margin-bottom: 8px;
        }
        .celestial-body li strong, #map-panel li strong {
            color: #bbb;
        }

        #map-panel h4 {
            margin-bottom: 10px;
            color: #bbb;
        }
        
        /* --- Dark Scrollbar Styling --- */
        .celestial-body::-webkit-scrollbar,
        #map-panel::-webkit-scrollbar,
        #manifest-panel::-webkit-scrollbar {
            width: 10px;
        }
        
        .celestial-body::-webkit-scrollbar-track,
        #map-panel::-webkit-scrollbar-track,
        #manifest-panel::-webkit-scrollbar-track {
            background: #1a1a1a;
            border-radius: 4px;
        }
        
        .celestial-body::-webkit-scrollbar-thumb,
        #map-panel::-webkit-scrollbar-thumb,
        #manifest-panel::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 4px;
        }
        
        .celestial-body::-webkit-scrollbar-thumb:hover,
        #map-panel::-webkit-scrollbar-thumb:hover,
        #manifest-panel::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* --- Manifest List Styling --- */
        .manifest-list {
            list-style-type: none;
            padding-left: 0;
            font-size: 0.85rem;
        }
        .manifest-list li {
            margin-bottom: 5px;
            color: #aaa;
        }
        .manifest-list strong {
            color: #ddd;
            min-width: 40px;
            display: inline-block;
        }
        .manifest-list ul {
            list-style-type: square;
            color: #888;
            padding-left: 20px;
            margin-top: 5px;
        }

        #manifest-panel::-webkit-scrollbar {
                display: none;
        }

        #manifest-panel {
                scrollbar-width: none; /* Firefox */
        }
 
        
        /* Highlight special bodies */
        .hl-landable { color: #8f9; }
        .hl-terraform { color: #61dafb; font-weight: bold; }
        .hl-earthlike { color: #61fbb0; font-weight: bold; text-transform: uppercase; }
        .hl-life { color: #fbd061; font-weight: bold; text-transform: uppercase; } 

        /* --- Gallery Section --- */
        #gallery-section {
            margin-top: 30px;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 20px;
            background-color: #2a2a2a;
        }
        
        #gallery-section h2 {
            color: #61dafb;
            margin-top: 0;
            margin-bottom: 15px;
        }
        
        .gallery-container {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 10px 0;
            height: 250px;
            scroll-behavior: smooth;
        }
        
        .gallery-container::-webkit-scrollbar {
            height: 10px;
        }
        
        .gallery-container::-webkit-scrollbar-track {
            background: #1a1a1a;
            border-radius: 4px;
        }
        
        .gallery-container::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 4px;
        }
        
        .gallery-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        .gallery-item {
            display: flex;           /* NEW */
            flex-direction: column;  /* NEW */
            flex-shrink: 0;
            width: 300px;
            height: 220px;
            border: 2px solid #444;
            border-radius: 8px;
            overflow: visible;
            cursor: pointer;
            transition: transform 0.2s, border-color 0.2s;
            position: relative; /* add this (replaces the one we removed) */
        }

        .gallery-item img {
            width: 100%;
            height: calc(100% - 36px); /* 100% of container minus caption height */
            object-fit: cover;         /* keeps the image nicely cropped */
        }

        .gallery-caption {
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #222;
            color: #ccc;
            font-size: 0.85rem;
        }
        #map-panel img {
            width: 100%;        /* responsive scaling */
            max-width: 275px;   /* make it bigger (was 200px) */
            margin-top: 35px;   /* move it down slightly */
            margin-left: auto;
            margin-right: auto;
            display: block;     /* keeps it centered */
            border-radius: 6px; /* optional, just looks nicer */
        }

        #map-panel img {
            box-shadow: 0 0 18px rgba(97, 218, 251, 0.18);
        }

        
        /* --- Lightbox Modal --- */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        
        .lightbox.active {
            display: flex;
        }
        
        .lightbox img {
            max-width: 90%;
            max-height: 90%;
            border-radius: 8px;
            box-shadow: 0 0 30px rgba(97, 218, 251, 0.3);
        }
        
        .lightbox-close {
            position: absolute;
            top: 30px;
            right: 40px;
            color: #fff;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .lightbox-close:hover {
            color: #61dafb;
        }
            
        .gallery-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(30, 30, 30, 0.95);
            color: #ddd;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.1s ease-out;
            margin-bottom: 6px;
            z-index: 50;
        }

        .gallery-item:hover .gallery-tooltip {
            opacity: 1;
        }

        /* Hide scrollbars everywhere, but keep scroll functionality */
        .celestial-body::-webkit-scrollbar,
        #map-panel::-webkit-scrollbar,
        #manifest-panel::-webkit-scrollbar,
        .gallery-container::-webkit-scrollbar {
            display: none;
        }

        .celestial-body,
        #map-panel,
        #manifest-panel,
        .gallery-container {
            scrollbar-width: none; /* Firefox */
        }

.audio-btn {
  background: none;
  border: none;
  color: #61dafb;
  font-size: 18px;      /* FIXED SIZE ‚Äî prevents wrapping */
  cursor: pointer;
  display: inline-flex; /* keeps it on the same line */
  align-items: center;
  vertical-align: middle;
  padding: 0;
  vertical-align: 0px; /* ‚Üê bump upward */

}

.audio-btn:active {
  transform: scale(0.9);
}




    </style>
</head>
<body>
    <div class="container">
        <h2>Nahla Day/Night Cycle Tracker - LIVE - v0.56 (Confidence Weighting)</h2>
        <div id="tracker">
            <div id="status">Loading...</div>
            <div id="hope">...</div>
            <div id="band">...</div>
            <div id="rebekah">...</div>
            <div id="moonclock">...</div>
            <div id="moonclock-coordinated">...</div>

            
            <div style="font-size: 0.9rem; color: #aaa; margin-top: 15px;">
                <a href="https://inara.cz/elite/cmdr/440263/" 
                    style="color: inherit; text-decoration: none;" 
                    target="_blank" 
                    rel="noopener noreferrer">
                    Living and studying on a remote moon since July 2025. By CMDR Lysander666 on Inara.
                </a>
            </div>

        </div>


        <h2>System Information</h2>

        <div id="system-info-container">
            
            <div class="celestial-body" id="nahla-info">
                <h3>Nahla (Moon)</h3>
                <ul>
                    <li><strong>Type:</strong> Rocky Sulphur Moon</li>
                    <li><strong>Mass:</strong> 0.0458 Earths</li>
                    <li><strong>Radius: 2,469 km</strong></li>
                    <li><strong>Atmosphere:</strong> None</li>
                    <li><strong>Gravity:</strong> 0.31 G</li>
                    <li><strong>Temp:</strong> 143 K - 275 K / -127C - 2C (Observed)</li>
                    <li><strong>Volcanism:</strong> Metallic magma, gas vents, fumaroles</li>
                    <li><strong>Orbital Period:</strong> 1.1 Earth days</li>
                    <li><strong>Rotation:</strong> 1.1 Earth days (Tidally Locked)</li>
                    <li><strong>Observation post:</strong> Miley (Mandalay) at Natalja's Pass (39.2, 104.3)</li>
                    <li>
                  <strong>Nahla ambience audio:</strong>
                  <button id="audio-btn" class="audio-btn">‚ñ∂</button>
                  <audio id="nahla-audio" src="nahla-ambience.mp3"></audio>
                </li>


                </ul>
            </div>

            <div class="celestial-body" id="rebekah-info">
                <h3>Rebekah (Parent)</h3>
                <ul>
                    <li><strong>Type:</strong> Class IV Gas Giant, ringed</li>
                    <li><strong>Mass:</strong> 3202.37 Earths</li>
                    <li><strong>Radius:</strong> 66,809 km</li>
                    <li><strong>Gravity:</strong> 29.19 G</li>
                    <li><strong>Temp:</strong> 908 K / 635C</li>
                    <li><strong>Atmosphere:</strong> H<sub>2</sub> (72.89%), He (27.11%)</li>
                    <li><strong>Distance from Primary:</strong> 2,885 ls </li>
                    <li><strong>Orbital Period:</strong> 555.2 Earth days</li>
                    <li><strong>Rotation:</strong> 0.4 Earth days</li>
                </ul>
            </div>

            <div class="celestial-body" id="hope-info">
                <h3>Hope (Primary Star)</h3>
                <ul>
                    <li><strong>Type:</strong> A5 Vb Blue-White Star</li>
                    <li><strong>Mass:</strong> 1.6758 Solar</li>
                    <li><strong>Radius:</strong> 1.427 Solar<li>
                    <li><strong>Temp:</strong> 8,631 K / 8,358 C</li>
                    <li><strong>Absolute magnitude:</strong> 2.3165 </li>
                    <li><strong>Age:</strong> 800 million years</li>
                    <li><strong>Rotation:</strong> 1.0 Earth days</li>
                    <li><strong>&nbsp;</strong></li> <li><strong>&nbsp;</strong></li> </ul>
            </div>

            <div id="map-panel">
                <h3>Hypi Bra EV-P d5-78</h3>
                <ul>
                    <li><strong>Dist. to Sol:</strong> 43,895.24 ly</li>
                    <li><strong>Dist. to Colonia:</strong> 22,698.70 ly</li>
                </ul>
                <h4>Galactic Position</h4>
                <img src="galaxy_map.png" alt="Galactic Position" onclick="openLightbox('galaxy_map.png')" style="cursor: pointer;">
            </div>

            <div id="manifest-panel">
                <h3>Full System Manifest</h3>
                <ul class="manifest-list">
                   <li><strong>A</strong> Blue-White Star (Hope) (Scoopable)</span>
                    </li>

                    <li><strong>A Belt</strong> Rocky Belt (Bellatrix)</li>

                    <li><strong>1</strong> Metal-rich body (Simone) (3,85 K)</span>
                    </li>

                    <li><strong>2</strong>Class III gas giant (Marika)
                        <ul>
                            <li><strong>2a</strong>Rocky body (Abelina) <span class="hl-landable">(L)</span></li>
                            <li><strong>2b</strong>Rocky body (Jana) <span class="hl-landable">(L)</span></li>
                            <li><strong>2c</strong>Rocky body (Mira) <span class="hl-landable">(L)</span></li>
                            <li><strong>2d</strong>Rocky body (Maria) <span class="hl-landable">(L)</span>
                                <ul><li><strong>2da</strong>Rocky body (Theresa) <span class="hl-landable">(L)</span></li></ul>
                            </li>
                            <li><strong>2e</strong>Rocky body (Bunika) <span class="hl-landable">(L)</span></li>
                        </ul>
                    </li>
                    <li><strong>3</strong>High metal content (Ru≈æena) (1,077 K)</span>
                    </li>
                    <li><strong>4</strong>Y (Brown dwarf) Star (Rayne)
                        <ul>
                            <li><strong>4a</strong>Rocky body (Ferril) <span class="hl-landable">(L)</span></li>
                        </ul>
                    </li>
                    <li><strong>5</strong><span class="hl-terraform">High metal content (B√°thory) (Terraform Candidate)</span>
                    </li>
                    <li><strong>6</strong>Class IV gas giant (Rebekah)
                        <ul>
                            <li><strong>6a</strong>Rocky body <span class="hl-landable">(L / Nahla)</span></li>
                            <li><strong>6b</strong>Icy body (Elena) </li>
                        </ul>
                    </li>
                    <li><strong>7</strong><span class="hl-life">Gas giant with water-based life (Aeoga)</span>
                    </li>
                        <ul>
                            <li><strong>7a</strong>Rocky body (Herbst9) <span class="hl-landable">(L)</span></li>
                            <li><strong>7b</strong>Rocky body (Asmorod) <span class="hl-landable">(L)</span></li>
                            <li><strong>7c</strong>Rocky body (Troum) <span class="hl-landable">(L)</span></li>
                        </ul>
                    </li>
                    <li><strong>8</strong><span class="hl-earthlike">*** Earth-like world *** (Ska√∞i) </span></li>
                    <li><strong>9</strong>Class IV gas giant (Draupadi)
                        <ul>
                            <li><strong>9a</strong>Rocky body (Sarasvati) <span class="hl-landable">(L)</span></li>
                            <li><strong>9b</strong>Rocky body (Gauri) <span class="hl-landable">(L)</span></li>
                            <li><strong>9c</strong>Rocky body (Chaumunda) <span class="hl-landable">(L)</span></li>
                            <li><strong>9d</strong>Rocky body (Rati) <span class="hl-landable">(L)</span>
                                <ul><li><strong>9da</strong>Rocky body (Kali) <span class="hl-landable">(L)</span></li></ul>
                            </li>
                        </ul>
                    </li>
                    <li><strong>10</strong>High metal content (Sita)</li>
                    <li><strong>11</strong>High metal content (Ariana)</li>
                    <li><strong>12</strong>High metal content (Anneke)</li>
                </ul>
            </div>
            
        </div>

     <div id="gallery-section">
       <div class="gallery-header">
    <button class="gallery-btn" id="scroll-left">&lt;</button>
    <h2>Gallery</h2>
    <button class="gallery-btn" id="scroll-right">&gt;</button>
</div>
             <div class="gallery-container">
<!--
        <div class="gallery-item" onclick="openLightbox('galaxy_map.png')">
            <div class="gallery-tooltip">Galactic Position Map</div>
            <img src="galaxy_map.png" alt="Galactic Position">
            <div class="gallery-caption">Galactic Position Map</div>
        </div>
--> 
        <div class="gallery-item" onclick="openLightbox('Nahla.jpg')">
            <div class="gallery-tooltip">Nahla</div>
            <img src="Nahla.jpg" alt="Nahla">
            <div class="gallery-caption">Nahla</div>
        </div>             

        <div class="gallery-item" onclick="openLightbox('Rebekah-from-Nahla.jpg')">
            <div class="gallery-tooltip">Rebekah seen from Nahla</div>
            <img src="Rebekah-from-Nahla.jpg" alt="Rebekah seen from Nahla">
            <div class="gallery-caption">Rebekah seen from Nahla</div>
        </div>
                     
        <div class="gallery-item" onclick="openLightbox('Pate-Sablee-Overhead.jpg')">
            <div class="gallery-tooltip">P√¢te Sabl√©e crater</div>
            <img src="Pate-Sablee-Overhead.jpg" alt="P√¢te Sabl√©e crater">
            <div class="gallery-caption">P√¢te Sabl√©e crater</div>
        </div>     

        <div class="gallery-item" onclick="openLightbox('galactic-band.jpg')">
            <div class="gallery-tooltip">Galactic band</div>
            <img src="galactic-band.jpg" alt="Galactic band">
            <div class="gallery-caption">Galactic band</div>
        </div>
                
        <div class="gallery-item" onclick="openLightbox('Natalja.jpg')">
            <div class="gallery-tooltip">Natalja's Pass</div>
            <img src="Natalja.jpg" alt="Natalja's Pass">
            <div class="gallery-caption">Natalja's Pass</div>
        </div>

        <div class="gallery-item" onclick="openLightbox('night.jpg')">
            <div class="gallery-tooltip">True Night</div>
            <img src="night.jpg" alt="Night">
            <div class="gallery-caption">True Night</div>
        </div>

         <div class="gallery-item" onclick="openLightbox('galacticnight.jpg')">
            <div class="gallery-tooltip">Galactic Night</div>
            <img src="galacticnight.jpg" alt="Galactic Night">
        <div class="gallery-caption">Galactic Night</div>
         </div>         
                
        <div class="gallery-item" onclick="openLightbox('hope.jpg')">
            <div class="gallery-tooltip">Hope</div>
            <img src="hope.jpg" alt="Hope">
            <div class="gallery-caption">Hope</div>
        </div>          

                          
    </div>
</div>

                <!-- Add more gallery items here with your screenshots -->
                <!-- Example template:
                <div class="gallery-item" onclick="openLightbox('your-image.jpg')">
                    <img src="your-image.jpg" alt="Description">
                    <div class="gallery-caption">Your Caption Here</div>
                </div>
                -->
            </div>
        </div>

        <!-- Lightbox Modal -->
        <div class="lightbox" id="lightbox" onclick="closeLightbox()">
            <span class="lightbox-close">&times;</span>
            <img id="lightbox-image" src="" alt="Enlarged view">
        </div>

        <div id="notes-box">
    <h2>Notes</h2>
    <div id="notes">
         <p><em>Clarification:</em> Nahla Coordinated time [NCT] isn‚Äôt truly 24 Earth hours. It‚Äôs a compressed version of Nahla‚Äôs 26h 24m solar day, scaled for reference and context. 
Every NCT 'second' lasts roughly 1.1 Earth seconds. Here we live by GMT. </p>
            <br>
            Day‚Äìnight cycles beyond Earth vary according to the orbital and rotational dynamics of their respective worlds, rather than adhering to Earth‚Äôs 24-hour rhythm.
            <p></p>
        <small>Nahla Tracker is a personal project of Lysander666.</small>

    </div>
</div>



    </div> <script>
        // --- Observational Anchor Model ---
        const MOON_NAME = "Nahla";
        const SECONDS_IN_EARTH_DAY = 24 * 60 * 60;
        
        // --- 1. OBSERVATION DATABASE ---
        // This is your new "database" of observations.
        // As you make new observations, add them here.
        // Use full ISO 8601 timestamps (with 'Z' for UTC/GMT).
        //
        // NEW EVENT TYPES:
        //  - "galactic_angle": { ..., degrees: 135 } (Corrects rotation to specific angle)
        //  - "hope_arc_progress": { ..., percent: 0.5 } (0.0 = Rise, 0.5 = Noon, 1.0 = Set)
        //  - "rebekah_arc_progress": { ..., percent: 0.1 } (0.0 = Rise, 1.0 = Set)
        //
        // WEIGHTING:
        //  - "weight": "precise" (Default) - Uses this observation for cycle calc AND current status
        //  - "weight": "estimate" - Uses this observation ONLY for current status (anchor), ignores for cycle calc
        
        const observations = [
            // --- Sun (Hope) Events ---
            { timestamp: "2025-11-09T20:00:00Z", event: "sunrise", weight: "precise" },
            { timestamp: "2025-11-16T23:25:00Z", event: "sunset", weight: "precise" },
            // Example of manual correction (uncomment to test):
            // { timestamp: "2025-11-17T12:00:00Z", event: "hope_arc_progress", percent: 0.5, weight: "estimate" }, 
            
            // ** YOUR NEW OBSERVATION **
            { timestamp: "2025-11-18T11:00:00Z", event: "hope_arc_progress", percent: 0.3, weight: "estimate" },

            // --- Rebekah Events ---
            { timestamp: "2025-11-09T21:30:00Z", event: "rebekah_rise", weight: "estimate" },
            { timestamp: "2025-11-16T10:30:00Z", event: "rebekah_rise", weight: "precise" },
            { timestamp: "2025-11-16T21:00:00Z", event: "rebekah_set", weight: "precise" },
            { timestamp: "2025-11-18T09:00:00Z", event: "rebekah_rise", weight: "estimate" },
            // Example of manual correction:
            // { timestamp: "2025-11-17T14:00:00Z", event: "rebekah_arc_progress", percent: 0.2, weight: "estimate" },

            // --- Galactic Band Events ---
            // User's "GALACTIC_VERTICAL_OBS" are mapped to "galactic_270" (or "galactic_angle" with degrees: 270)
            { timestamp: "2025-11-15T15:00:00Z", event: "galactic_270", weight: "precise" },
            { timestamp: "2025-11-16T16:00:00Z", event: "galactic_270", weight: "precise" },
            { timestamp: "2025-11-18T11:30:00Z", event: "galactic_angle", degrees: 90, weight: "precise" },
            // Example of arbitrary angle correction:
            // { timestamp: "2025-11-17T10:00:00Z", event: "galactic_angle", degrees: 45, weight: "estimate" } 
        ];

        // --- 2. FALLBACK CYCLE ESTIMATES (in Earth Days) ---
        const FALLBACK_SOLAR_CYCLE_DAYS = 1.1;
        const FALLBACK_REBEKAH_CYCLE_DAYS = 1.1; 
        const FALLBACK_GALACTIC_CYCLE_DAYS = 1.1; 

        // --- 3. MANUAL DURATION CONSTANTS (FALLBACKS) ---
        const MANUAL_REBEKAH_VISIBLE_DURATION_SECONDS = 1.1 * SECONDS_IN_EARTH_DAY / 2; 
        const MANUAL_REBEKAH_HORIZON_DURATION_SECONDS = 1.1 * SECONDS_IN_EARTH_DAY / 2; 

        
        // --- 4. DYNAMIC CONSTANT CALCULATION ---
        
        // Helper to get the most recent observation of a specific type
        function getMostRecentObservation(eventType) {
            const events = observations
                .filter(obs => obs.event === eventType)
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp)); 
            
            if (events.length > 0) {
                return events[0]; // Return the whole object, not just timestamp
            }
            return null; 
        }
        
        // Helper to calculate cycle length (rate of change)
        // This still prioritizes "hard" events like sunrise/sunset/270 for accuracy
        // NEW: Ignores 'estimate' weights for calculation, effectively protecting the "clock speed"
        function calculateCycleLength(eventType, fallbackCycleDays) {
            // Mapping for cycle calc:
            let targetEvent = eventType;
            if (eventType === 'galactic_270') {
                 // Include both 'galactic_270' AND 'galactic_angle' if degrees==270
                 // But for now, let's stick to the explicitly named events for cycle stability
            }

            // FILTER: Only use PRECISE observations for cycle calculation
            const events = observations
                .filter(obs => obs.event === targetEvent && obs.weight !== 'estimate')
                .sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp)); 

            let cycleLengthSeconds;
            let lastAnchor;
            const fallbackCycleMs = fallbackCycleDays * SECONDS_IN_EARTH_DAY * 1000;

            if (events.length === 0) {
                console.warn(`No precise '${eventType}' observations found! Using fallback.`);
                cycleLengthSeconds = fallbackCycleMs / 1000;
                // Fallback anchor: try finding ANY observation (even estimate) just to have something
                const anyEvent = observations
                    .filter(obs => obs.event === targetEvent)
                    .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                lastAnchor = anyEvent.length > 0 ? new Date(anyEvent[0].timestamp) : new Date();
            } else if (events.length === 1) {
                console.warn(`Only one precise '${eventType}' observation. Using fallback day length.`);
                cycleLengthSeconds = fallbackCycleMs / 1000;
                lastAnchor = new Date(events[events.length - 1].timestamp); 
            } else {
                const genesisEvent = new Date(events[0].timestamp);
                const latestEvent = new Date(events[events.length - 1].timestamp);
                const totalTimeMs = latestEvent.getTime() - genesisEvent.getTime();
                const estimatedCycles = Math.round(totalTimeMs / fallbackCycleMs);

                if (estimatedCycles === 0) {
                    console.warn(`Observations for '${eventType}' are too close. Using fallback day length.`);
                    cycleLengthSeconds = fallbackCycleMs / 1000;
                    lastAnchor = latestEvent;
                } else {
                    const avgCycleDurationMs = totalTimeMs / estimatedCycles;
                    cycleLengthSeconds = avgCycleDurationMs / 1000;
                    lastAnchor = latestEvent; 
                    console.log(`Multi-anchor for ${eventType}: ${estimatedCycles} cycles detected. New avg: ${cycleLengthSeconds}s`);
                }
            }
            
            return { cycleLength: cycleLengthSeconds, anchor: lastAnchor };
        }

        // Helper to auto-calculate durations from paired events
        // NOTE: This logic assumes paired events are PRECISE enough to determine duration.
        // We filter out estimates here too? Or maybe we trust user paired estimates?
        // Let's filter out estimates for duration calculation to be safe.
        function calculateRebekahDurations() {
            let visibleDuration = MANUAL_REBEKAH_VISIBLE_DURATION_SECONDS;
            let horizonDuration = MANUAL_REBEKAH_HORIZON_DURATION_SECONDS;

            const riseEvents = observations.filter(obs => obs.event === 'rebekah_rise' && obs.weight !== 'estimate').sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            const setEvents = observations.filter(obs => obs.event === 'rebekah_set' && obs.weight !== 'estimate').sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

            if (riseEvents.length > 0 && setEvents.length > 0) {
                const lastRise = new Date(riseEvents[0].timestamp);
                const matchingSet = setEvents.map(e => new Date(e.timestamp)).find(s => s.getTime() > lastRise.getTime());

                if (matchingSet) {
                    visibleDuration = (matchingSet.getTime() - lastRise.getTime()) / 1000;
                    console.log(`Auto-calculated Rebekah VISIBLE duration: ${visibleDuration}s`);
                } else {
                     // Check previous pair
                    const lastSet = new Date(setEvents[0].timestamp);
                    if (lastSet.getTime() < lastRise.getTime()) {
                        const matchingRise = riseEvents.map(e => new Date(e.timestamp)).find(r => r.getTime() < lastSet.getTime());
                        if (matchingRise) {
                             visibleDuration = (lastSet.getTime() - matchingRise.getTime()) / 1000;
                        }
                    }
                }
            }
            
             if (riseEvents.length > 0 && setEvents.length > 0) {
                const lastSet = new Date(setEvents[0].timestamp);
                const matchingRise = riseEvents.map(e => new Date(e.timestamp)).find(r => r.getTime() > lastSet.getTime());
                if (matchingRise) {
                    horizonDuration = (matchingRise.getTime() - lastSet.getTime()) / 1000;
                    console.log(`Auto-calculated Rebekah HORIZON duration: ${horizonDuration}s`);
                } else {
                     const lastRise = new Date(riseEvents[0].timestamp);
                     if(lastRise.getTime() < lastSet.getTime()){
                        const matchingSet = setEvents.map(e => new Date(e.timestamp)).find(s => s.getTime() < lastRise.getTime());
                        if(matchingSet){
                            horizonDuration = (lastRise.getTime() - matchingSet.getTime()) / 1000;
                        }
                     }
                }
            }
            return { visibleDuration: visibleDuration, horizonDuration: horizonDuration };
        }


        // --- INIT CLOCKS ---
        
        // CLOCK 1: Sun (Hope)
        const solarData = calculateCycleLength("sunrise", FALLBACK_SOLAR_CYCLE_DAYS);
        const SOLAR_DAY_LENGTH_SECONDS = solarData.cycleLength;
        const LAST_SUNRISE_ANCHOR = solarData.anchor;
        const HALF_SOLAR_DAY_SECONDS = SOLAR_DAY_LENGTH_SECONDS / 2;
        
        // CLOCK 2: Rebekah
        const rebekahData = calculateCycleLength("rebekah_rise", FALLBACK_REBEKAH_CYCLE_DAYS);
        const REBEKAH_TOTAL_CYCLE_SECONDS = rebekahData.cycleLength;
        const REBEKAH_LAST_RISE_ANCHOR = rebekahData.anchor;

        const rebekahDurations = calculateRebekahDurations();
        const REBEKAH_VISIBLE_DURATION = rebekahDurations.visibleDuration;
        const REBEKAH_HORIZON_DURATION = rebekahDurations.horizonDuration;

        // CLOCK 3: Galactic Band
        const galacticData = calculateCycleLength("galactic_270", FALLBACK_GALACTIC_CYCLE_DAYS);
        const GALACTIC_TOTAL_CYCLE_SECONDS = galacticData.cycleLength;
        const GALACTIC_270_ANCHOR = galacticData.anchor;
            

        // --- GET ANCHORS FOR DISPLAY ---
        
        // Helper function to find the most recent observation of ANY type in a list
        // This INCLUDES estimates, because we want the latest status update regardless of quality
        function getLatestObservationFromList(eventTypes) {
             const relevant = observations
                .filter(obs => eventTypes.includes(obs.event))
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            return relevant.length > 0 ? relevant[0] : null;
        }

        // --- All your helper functions, ported to JavaScript ---
        
        function format_timedelta(total_seconds) {
            total_seconds = Math.max(0, total_seconds);
            const hours = Math.floor(total_seconds / 3600);
            const minutes = Math.floor((total_seconds % 3600) / 60);
            const seconds = Math.floor(total_seconds % 60);
            return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        function get_rebekah_status(current_time) {
            // 1. Check for arbitrary arc progress correction FIRST
            const latestArcObs = getLatestObservationFromList(['rebekah_arc_progress']);
            // 2. Check for standard Rise/Set events (PRECISE ONLY for display preference? No, take estimates too if newer)
            // We use getLatestObservationFromList logic (all weights) here implicitly if we just query list
            const latestRise = getMostRecentObservation('rebekah_rise');
            const latestSet = getMostRecentObservation('rebekah_set');
            
            // Determine which observation is actually the MOST recent
            let anchorType = 'none';
            let anchorTime = 0;
            let anchorVal = 0; // could be percent, or just event type
            
            const obsCandidates = [];
            if (latestArcObs) obsCandidates.push({ t: new Date(latestArcObs.timestamp).getTime(), type: 'arc', obj: latestArcObs });
            if (latestRise) obsCandidates.push({ t: new Date(latestRise.timestamp).getTime(), type: 'rise', obj: latestRise });
            if (latestSet) obsCandidates.push({ t: new Date(latestSet.timestamp).getTime(), type: 'set', obj: latestSet });
            
            obsCandidates.sort((a, b) => b.t - a.t); // Descending
            
            if (obsCandidates.length === 0) return `<strong>Rebekah:</strong> ‚îÄ STATUS UNKNOWN`;
            
            const latest = obsCandidates[0];
            const timeSince = (current_time.getTime() - latest.t) / 1000;
            
            let isVisible = false;
            let timeRemaining = 0;
            let statusText = "";

            if (latest.type === 'arc') {
                // Arbitrary correction logic!
                // We assume the user input a percent (0.0 - 1.0) of the VISIBLE phase.
                // If they input > 1.0 (e.g. 1.1), maybe they mean it's set? 
                // Let's assume "arc_progress" implies visibility.
                const percentDone = latest.obj.percent;
                const secondsDone = percentDone * REBEKAH_VISIBLE_DURATION;
                const totalSecondsDone = secondsDone + timeSince;
                
                if (totalSecondsDone < REBEKAH_VISIBLE_DURATION) {
                    isVisible = true;
                    timeRemaining = REBEKAH_VISIBLE_DURATION - totalSecondsDone;
                    statusText = "(Manual Arc)";
                } else {
                    isVisible = false;
                    // How far into horizon?
                    const timeIntoHorizon = totalSecondsDone - REBEKAH_VISIBLE_DURATION;
                    const horizonPhase = timeIntoHorizon % REBEKAH_HORIZON_DURATION;
                    timeRemaining = REBEKAH_HORIZON_DURATION - horizonPhase;
                    statusText = "(Manual Arc -> Set)";
                }

            } else if (latest.type === 'rise') {
                // Standard Rise logic
                const timeIntoPhase = (timeSince % REBEKAH_VISIBLE_DURATION + REBEKAH_VISIBLE_DURATION) % REBEKAH_VISIBLE_DURATION;
                timeRemaining = REBEKAH_VISIBLE_DURATION - timeIntoPhase;
                isVisible = true;
                //statusText = "(Auto-Calc)";
            } else { // set
                // Standard Set logic
                const timeIntoPhase = (timeSince % REBEKAH_HORIZON_DURATION + REBEKAH_HORIZON_DURATION) % REBEKAH_HORIZON_DURATION;
                timeRemaining = REBEKAH_HORIZON_DURATION - timeIntoPhase;
                isVisible = false;
                //statusText = "(Auto-Calc)";
            }

            if (isVisible) {
                return `<strong>Rebekah:</strong> ü™ê VISIBLE | Est. set in: <span class="time-highlight">${format_timedelta(timeRemaining)}</span> ${statusText}`;
            } else {
                return `<strong>Rebekah:</strong> ‚îÄ below horizon | Est. rise in: <span class="time-highlight">${format_timedelta(timeRemaining)}</span> ${statusText}`;
            }
        }

        function get_sky_arc_indicator(progress, is_daytime) {
            if (is_daytime) {
                const positions = ["üåÖ", "‚òÄÔ∏è", "‚òÄÔ∏è", "‚òÄÔ∏è", "‚òÄÔ∏è", "üåá"];
                // Ensure progress is 0-1
                let p = Math.max(0, Math.min(1, progress));
                const index = Math.floor(p * (positions.length - 1));
                let arc = ["‚îÄ", "‚îÄ", "‚îÄ", "‚îÄ", "‚îÄ", "‚îÄ"];
                arc[index] = positions[index];
                return `<strong>Hope:</strong> [${arc.join("")}]`;
            } else {
                return "<strong>Hope:</strong> [‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ] (below horizon)";
            }
        }

        function get_galactic_band_indicator(current_time, is_daytime) {
            // 1. Find latest observation: 'galactic_270' OR 'galactic_angle'
            const latestObs = getLatestObservationFromList(['galactic_270', 'galactic_angle']);
            
            if (!latestObs) return `<strong>Galactic Band:</strong> ‚îÄ STATUS UNKNOWN`;

            const timeSince = (current_time.getTime() - new Date(latestObs.timestamp).getTime()) / 1000;
            const currentCycleSeconds = (timeSince % GALACTIC_TOTAL_CYCLE_SECONDS + GALACTIC_TOTAL_CYCLE_SECONDS) % GALACTIC_TOTAL_CYCLE_SECONDS;
            const progress = currentCycleSeconds / GALACTIC_TOTAL_CYCLE_SECONDS; // 0.0 to 1.0 relative to anchor

            // Determine Anchor Degrees
            let anchorDegrees = 270; // Default for 'galactic_270'
            if (latestObs.event === 'galactic_angle' && latestObs.degrees !== undefined) {
                anchorDegrees = latestObs.degrees;
            }

            // Calculate current degrees
            const degreesMoved = progress * 360;
            const currentDegrees = (anchorDegrees + degreesMoved) % 360;
            
            let phase;
            if (currentDegrees >= 270 && currentDegrees < 360) {
                phase = "Phase 1: Setting";
            } else if (currentDegrees >= 0 && currentDegrees < 90) {
                phase = "Phase 2: Nadir/Returning";
            } else if (currentDegrees >= 90 && currentDegrees < 180) {
                phase = "Phase 3: Rising";
            } else { // degrees >= 180 && degrees < 270
                phase = "Phase 4: Zenith/Peak";
            }

            const visibility = is_daytime ? "(daylight)" : "(visible)";

            return `<strong>Galactic Band:</strong> üåå ${phase} (${currentDegrees.toFixed(1)}¬∞) ${visibility}`;
        }

        // --- The main update loop ---
        function updateDisplay() {
            const current_time = new Date();
            
            // --- Clock-related calculations (Hope/Sun) ---
            // Similar logic: check for manual arc correction vs standard sunrise/set
            const latestArcObs = getLatestObservationFromList(['hope_arc_progress']);
            const latestSunrise = getMostRecentObservation('sunrise');
            const latestSunset = getMostRecentObservation('sunset');

             // Determine best anchor for Hope
            let anchorType = 'none';
            const obsCandidates = [];
            if (latestArcObs) obsCandidates.push({ t: new Date(latestArcObs.timestamp).getTime(), type: 'arc', obj: latestArcObs });
            if (latestSunrise) obsCandidates.push({ t: new Date(latestSunrise.timestamp).getTime(), type: 'sunrise', obj: latestSunrise });
            if (latestSunset) obsCandidates.push({ t: new Date(latestSunset.timestamp).getTime(), type: 'sunset', obj: latestSunset });
            
            obsCandidates.sort((a, b) => b.t - a.t);

            let isDaytime = true;
            let dayProgress = 0; // 0.0 - 1.0
            let timeUntilChange = 0;
            let statusText = "";
            
            // Clock display calculation (still needs strict anchor, falling back to sunrise)
            if (!LAST_SUNRISE_ANCHOR) {
                 document.getElementById("status").innerHTML = "ERROR: No Sunrise Data";
                 return;
            }
            const time_since_clock_anchor = (current_time - LAST_SUNRISE_ANCHOR) / 1000; 
            const current_cycle_seconds = (time_since_clock_anchor % SOLAR_DAY_LENGTH_SECONDS + SOLAR_DAY_LENGTH_SECONDS) % SOLAR_DAY_LENGTH_SECONDS;
            const hours_into_moon_day = (current_cycle_seconds / SOLAR_DAY_LENGTH_SECONDS) * (SOLAR_DAY_LENGTH_SECONDS / 3600);

            if (obsCandidates.length > 0) {
                const latest = obsCandidates[0];
                const timeSince = (current_time.getTime() - latest.t) / 1000;
                
                if (latest.type === 'arc') {
                    // Manual correction
                    const percentDone = latest.obj.percent; // 0.0 - 1.0 of DAYLIGHT
                    // We assume manual arc correction implies DAYTIME unless user specifies otherwise? 
                    // Actually, usually arc progress implies sun is visible.
                    const dayDuration = HALF_SOLAR_DAY_SECONDS; 
                    const secondsDone = percentDone * dayDuration;
                    const totalSeconds = secondsDone + timeSince;
                    
                    if (totalSeconds < dayDuration) {
                        isDaytime = true;
                        timeUntilChange = dayDuration - totalSeconds;
                        dayProgress = totalSeconds / dayDuration;
                        statusText = "(Manual Arc)";
                    } else {
                        isDaytime = false;
                        const nightTime = totalSeconds - dayDuration;
                        timeUntilChange = dayDuration - (nightTime % dayDuration); // assuming night = day length
                        dayProgress = 0; // it's night
                        statusText = "(Manual Arc -> Night)";
                    }

                } else if (latest.type === 'sunrise') {
                    const cyclePos = timeSince % SOLAR_DAY_LENGTH_SECONDS;
                    if (cyclePos < HALF_SOLAR_DAY_SECONDS) {
                        isDaytime = true;
                        timeUntilChange = HALF_SOLAR_DAY_SECONDS - cyclePos;
                        dayProgress = cyclePos / HALF_SOLAR_DAY_SECONDS;
                    } else {
                        isDaytime = false;
                        timeUntilChange = SOLAR_DAY_LENGTH_SECONDS - cyclePos;
                    }
                } else { // sunset
                     const cyclePos = timeSince % SOLAR_DAY_LENGTH_SECONDS;
                     // Sunset starts at "Night" (0 time into night)
                     if (cyclePos < HALF_SOLAR_DAY_SECONDS) {
                         isDaytime = false;
                         timeUntilChange = HALF_SOLAR_DAY_SECONDS - cyclePos;
                     } else {
                         // Wrapped around to day
                         isDaytime = true;
                         timeUntilChange = SOLAR_DAY_LENGTH_SECONDS - cyclePos;
                         dayProgress = (cyclePos - HALF_SOLAR_DAY_SECONDS) / HALF_SOLAR_DAY_SECONDS;
                     }
                }
            }

            let data = {};
            
            if (isDaytime) {
                data.status = `‚òÄÔ∏è  DAY on ${MOON_NAME} | Sunset in: <span class="time-highlight">${format_timedelta(timeUntilChange)}</span> | <span class="time-highlight">${hours_into_moon_day.toFixed(2)}h</span> into solar day ${statusText}`;
                data.hope = get_sky_arc_indicator(dayProgress, true);
                data.band = get_galactic_band_indicator(current_time, true);
            } else {
                // Calculate night progress for arc (0 to 1)
                // If it's night, timeUntilChange is time until sunrise.
                // Progress = 1 - (remaining / total_night)
                const nightProgress = 1.0 - (timeUntilChange / HALF_SOLAR_DAY_SECONDS);
                
                data.status = `üåô NIGHT on ${MOON_NAME} | Sunrise in: <span class="time-highlight">${format_timedelta(timeUntilChange)}</span> | <span class="time-highlight">${hours_into_moon_day.toFixed(2)}h</span> into solar day ${statusText}`;
                data.hope = get_sky_arc_indicator(nightProgress, false);
                data.band = get_galactic_band_indicator(current_time, false);
            }

            data.rebekah = get_rebekah_status(current_time);

            // Update the HTML
            document.getElementById("status").innerHTML = data.status;
            document.getElementById("hope").innerHTML = data.hope;
            document.getElementById("band").innerHTML = data.band;
            document.getElementById("rebekah").innerHTML = data.rebekah;
        }

        // --- CLOCK FUNCTIONS (UNCHANGED) ---
        function updateClocks() {
            if (!LAST_SUNRISE_ANCHOR) {
                document.getElementById('moonclock').textContent = "Nahla Local Time: ERROR";
                document.getElementById('moonclock-coordinated').textContent = "Nahla Coordinated Time: ERROR";
                return;
            }
            document.getElementById('moonclock').textContent = get_moon_clock();
            document.getElementById('moonclock-coordinated').textContent = get_nahla_coordinated_time();
        }


        function get_moon_clock() {
            const now_ms = Date.now(); 
            const time_since_sunrise_ms = (now_ms - LAST_SUNRISE_ANCHOR.getTime()); 
            const current_cycle_ms = (time_since_sunrise_ms % (SOLAR_DAY_LENGTH_SECONDS * 1000) + (SOLAR_DAY_LENGTH_SECONDS * 1000)) % (SOLAR_DAY_LENGTH_SECONDS * 1000);
            
            const total_seconds = current_cycle_ms / 1000;
            const hours = Math.floor(total_seconds / 3600);
            const minutes = Math.floor((total_seconds % 3600) / 60);
            const seconds = Math.floor(total_seconds % 60);
            const ms = Math.floor((total_seconds % 1) * 100); 

            return `Nahla Local Time: ${String(hours).padStart(2, '0')}:` +
               `${String(minutes).padStart(2, '0')}:` +
               `${String(seconds).padStart(2, '0')}.` +
               `${String(ms).padStart(2, '0')} (out of ${(SOLAR_DAY_LENGTH_SECONDS / 3600).toFixed(2)}h)`;
        }


        function get_nahla_coordinated_time() {
            const now_ms = Date.now();
            const time_since_sunrise_ms = (now_ms - LAST_SUNRISE_ANCHOR.getTime());
            const current_cycle_ms = (time_since_sunrise_ms % (SOLAR_DAY_LENGTH_SECONDS * 1000) + (SOLAR_DAY_LENGTH_SECONDS * 1000)) % (SOLAR_DAY_LENGTH_SECONDS * 1000);

            const total_seconds = current_cycle_ms / 1000;

            // Scale the *current* number of seconds into a 24-hour day
            const SCALE = (24 * 3600) / SOLAR_DAY_LENGTH_SECONDS;
            const scaled_seconds = total_seconds * SCALE;

            const hours   = Math.floor(scaled_seconds / 3600);
            const minutes = Math.floor((scaled_seconds % 3600) / 60);
            const seconds = Math.floor(scaled_seconds % 60);
            const ms = Math.floor((scaled_seconds % 1) * 100); 

            return `Nahla Coordinated Time: ${String(hours).padStart(2, '0')}:` +
                   `${String(minutes).padStart(2, '0')}:` +
                   `${String(seconds).padStart(2, '0')}.` +
                   `${String(ms).padStart(2, '0')} (out of 24:00:00)`;
        }


        // --- Main Execution ---
        
        updateDisplay();
        setInterval(updateDisplay, 1000);

        updateClocks();
        setInterval(updateClocks, 50); 

        // --- Gallery Lightbox Functions ---
        function openLightbox(imageSrc) {
            const lightbox = document.getElementById('lightbox');
            const lightboxImage = document.getElementById('lightbox-image');
            lightboxImage.src = imageSrc;
            lightbox.classList.add('active');
        }
        
        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.remove('active');
        }
        
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeLightbox();
            }
        });

            // --- Make gallery draggable ---
        const gallery = document.querySelector('.gallery-container');

        let isDown = false;
        let startX;
        let scrollLeft;

        gallery.addEventListener('mousedown', (e) => {
          isDown = true;
          gallery.classList.add('active');
          startX = e.pageX - gallery.offsetLeft;
          scrollLeft = gallery.scrollLeft;
        });

        gallery.addEventListener('mouseleave', () => {
          isDown = false;
        });

        gallery.addEventListener('mouseup', () => {
          isDown = false;
        });

        gallery.addEventListener('mousemove', (e) => {
          if (!isDown) return;
          e.preventDefault();
          const x = e.pageX - gallery.offsetLeft;
          const walk = (x - startX) * 1.3; 
          gallery.scrollLeft = scrollLeft - walk;
        });

            const scrollLeftBtn = document.getElementById('scroll-left');
const scrollRightBtn = document.getElementById('scroll-right');

const scrollAmount = 630; 

scrollLeftBtn.addEventListener('click', () => {
    gallery.scrollBy({
        left: -scrollAmount,
        behavior: 'smooth'
    });
});

scrollRightBtn.addEventListener('click', () => {
    gallery.scrollBy({
        left: scrollAmount,
        behavior: 'smooth'
    });
});

const audio = document.getElementById("nahla-audio");
const btn = document.getElementById("audio-btn");

btn.addEventListener("click", () => {
  if (audio.paused) {
    audio.play();
    btn.textContent = "‚è∏";  // Pause icon
  } else {
    audio.pause();
    btn.textContent = "‚ñ∂";  // Play icon
  }
});

            

    </script>
</body>
</html>
